!function(a){var t,n=function(a){e(a)||a.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},e=function(a){return a.is(".processing")||a.parents(".processing").length},o=function(a){a.removeClass("processing").unblock()};a("#cust_question").on("keyup",function(){var e=a(this).val();clearTimeout(t),t=setTimeout(function(){if(a("#qna-result-msg").html(""),n(a("#cust_qna_form")),e.length>3){var t={action:"wcmp_customer_ask_qna_handler",handler:"search",product_ID:a("#product_ID").val(),keyword:e};a.post(woocommerce_params.ajax_url,t,function(t){o(a("#cust_qna_form")),1==t.no_data?(a("#qna-result-msg").html(t.message),a("#qna-result-wrap").html(""),a("#ask-wrap").show()):a("#qna-result-wrap").html(t.data)})}else{a("#ask-wrap").hide();var t={action:"wcmp_customer_ask_qna_handler",handler:"search",product_ID:a("#product_ID").val(),keyword:""};a.post(woocommerce_params.ajax_url,t,function(t){o(a("#cust_qna_form")),1==t.no_data?(a("#qna-result-msg").html(t.message),a("#qna-result-wrap").html(""),a("#ask-wrap").show()):a("#qna-result-wrap").html(t.data)})}},500)}),a("body").on("click","#ask-qna",function(){a("#qna-result-msg").html(""),n(a("#cust_qna_form"));var t={action:"wcmp_customer_ask_qna_handler",handler:"submit",customer_qna_data:a("#customerqnaform").serialize()};a.post(woocommerce_params.ajax_url,t,function(t){0==t.no_data&&(o(a("#cust_qna_form")),setTimeout(function(){a("#ask-wrap").hide(),a("#cust_question").val(""),a("#qna-result-msg").html(t.message),window.location.reload()},3e3))})}),a("body").on("click","button.wcmp-add-qna-reply",function(){var t=a(this).attr("data-key"),n=a("#qna-reply-"+t).val();if(""===n)return!1;var e={action:"wcmp_customer_ask_qna_handler",handler:"answer",reply:n,key:t};a.post(woocommerce_params.ajax_url,e,function(n){0==n.no_data&&(a("#reply-item-"+t).hide(),0==n.remain_data&&(a(".customer-questions-panel").html(""),a(".customer-questions-panel").html(n.msg)),setTimeout(a("#qna-reply-modal-"+t).modal("hide"),3e3))})}),a("body").on("click",".qna-actions .give-vote-btn",function(t){t.preventDefault(),n(a("#cust_qna_form"));var e=a(this).attr("data-vote"),r=a(this).attr("data-ans");if(""===e)return!1;var s={action:"wcmp_customer_ask_qna_handler",handler:"vote_answer",vote:e,ans_ID:r};a.post(woocommerce_params.ajax_url,s,function(t){o(a("#cust_qna_form")),0==t.no_data&&setTimeout(function(){window.location.reload()},1e3)})})}(jQuery);