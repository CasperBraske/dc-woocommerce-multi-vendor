var removed_person_types=[],removed_variations=[],resetMultiInputIndex,addMultiInputProperty;jQuery(document).ready(function(e){function t(i,o,a,n){i.children(".multi_input_block:not(:last)").remove();var r=i.attr("id");r=r.replace(o+"_","");for(var d=r.split("_"),l="",_=0;_<d.length-1;_++)""!=l&&(l+="_"),l+=d[_];i.attr("data-name",a+"["+n+"]["+l+"]"),i.attr("id",o+"_"+l+"_"+n),i.children(".multi_input_block").find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),i=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var r=t;i=r.find(".multi_input_block_element").data("name"),r.find("img").attr("src","").attr("id",o+"_"+i+"_"+n+"_display").addClass("placeHolder"),r.find(".multi_input_block_element").attr("id",o+"_"+l+"_"+n+"_"+i+"_0").attr("name",a+"["+n+"]["+l+"][0]["+i+"]"),r.find(".upload_button").attr("id",o+"_"+i+"_"+n+"_button").show(),r.find(".remove_button").attr("id",o+"_"+i+"_"+n+"_remove_button").hide(),addDCUploaderProperty(r)}else{var d=t.attr("multiple");"undefined"!=typeof d&&d!==!1?t.attr("name",a+"["+n+"]["+l+"][0]["+i+"][]"):t.attr("name",a+"["+n+"]["+l+"][0]["+i+"]"),t.attr("id",o+"_"+l+"_"+n+"_"+i+"_0")}t.hasClass("dc_datepicker")?t.removeClass("hasDatepicker").datepicker({dateFormat:t.data("date_format"),changeMonth:!0,changeYear:!0}):t.hasClass("time_picker")&&(e(".time_picker").timepicker("remove").timepicker({step:15}),t.timepicker("remove").timepicker({step:15}))}),addMultiInputProperty(i),i.children(".multi_input_block").children(".multi_input_holder").length>0&&i.children(".multi_input_block").css("padding-bottom","40px"),i.children(".multi_input_block").children(".multi_input_holder").each(function(){t(e(this),o+"_"+l+"_0",a+"["+n+"]["+l+"]",0)})}function i(){$is_valid=!0,e(".woocommerce-error,.woocommerce-message").remove();var t=e.trim(e("#product_manager_form").find("#title").val());return 0==t.length&&($is_valid=!1,e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+product_manager_messages.no_title+"</div>"),e(".woocommerce-error").focus()),$is_valid}var o=function(e){a(e)||e.addClass("processing").block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},a=function(e){return e.is(".processing")||e.parents(".processing").length},n=function(e){e.removeClass("processing").unblock()};e.isFunction(e.fn.singleProductMulipleVendor)&&(e("#product_manager_form input[name=title]").singleProductMulipleVendor({ajaxurl:woocommerce_params.ajax_url,is_admin:!1}),e("body").on("click","#wcmp_auto_suggest_product_title ul li a",function(){o(e("#product_manager_form"));var t=e(this).data("product_id"),i={action:"wcmp_create_duplicate_product",product_id:t};e.post(woocommerce_params.ajax_url,i,function(t){n(e("#product_manager_form")),t.status&&(window.location.href=t.redirect_url)})})),e("#frontend_product_manager_accordion").accordion({heightStyle:"content",collapsible:!0,activate:function(e,t){t.newHeader.hasClass("variations")&&resetVariationsAttributes()}}),e("#product_cats").select2({placeholder:"Choose ..."}),e(".product_taxonomies").select2({placeholder:"Choose ..."}),e("#upsell_ids").select2({placeholder:"Choose ..."}),e("#crosssell_ids").select2({placeholder:"Choose ..."}),e(".manage_stock_ele").change(function(){e(this).is(":checked")?e(this).parents(".pro_ele_block").first().find(".non_manage_stock_ele").removeClass("non_stock_ele_hide"):e(this).parents(".pro_ele_block").first().find(".non_manage_stock_ele").addClass("non_stock_ele_hide")}).change();var r=["simple"];e("#product_type").length>0?(e("#product_type").change(function(t){void 0!==t.originalEvent&&(e("#frontend_product_manager_accordion").accordion("option","active",0),e("#frontend_product_manager_accordion").accordion("refresh"));var i=e(this).val();e(".pro_ele_head").addClass("pro_head_hide"),e(".pro_ele_block").addClass("pro_block_hide"),e(".pro_ele").addClass("pro_ele_hide"),e(".frontend_product_manager_product_types > .description").addClass("pro_ele_hide"),e("."+i).removeClass("pro_ele_hide pro_block_hide pro_head_hide"),"simple"==i&&e(".frontend_product_manager_product_types > .description").removeClass("pro_ele_hide"),e("#is_downloadable").change(),-1==e.inArray(i,r)&&(e(".simple").removeClass("pro_ele_hide pro_block_hide pro_head_hide"),e(".non-"+i).addClass("pro_ele_hide pro_block_hide pro_head_hide")),e(document.body).trigger("product_type_changed")}).change(),e("#is_downloadable").change(function(){e(this).is(":checked")?e(".downlodable").removeClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".downlodable").addClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),e(".is_downloadable_hidden").change(function(){"enable"==e(this).val()?e(".downlodable").removeClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".downlodable").addClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),0==e("#is_downloadable").length&&e(".downlodable").addClass("downloadable_ele_hide"),e("#is_virtual").change(function(){e(this).is(":checked")?e(".nonvirtual").addClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".nonvirtual").removeClass("pro_ele_hide pro_block_hide pro_head_hide")}).change(),e(".is_virtual_hidden").change(function(){"enable"==e(this).val()?e(".nonvirtual").addClass("pro_ele_hide pro_block_hide pro_head_hide"):e(".nonvirtual").removeClass("pro_ele_hide pro_block_hide pro_head_hide")}).change()):(e(".pro_ele_head").addClass("pro_head_hide"),e(".pro_ele_block").addClass("pro_block_hide"),e(".pro_ele").addClass("pro_ele_hide")),e(".img_tip").each(function(){e(this).qtip({content:e(this).attr("data-desc"),position:{my:"center left",at:"center right",viewport:e(window)},show:{event:"mouseover",solo:!0},hide:{inactive:6e3,fixed:!0},style:{classes:"qtip-dark qtip-shadow qtip-rounded qtip-dc-css"}})}),e(".dc_datepicker").each(function(){e(this).datepicker({dateFormat:e(this).data("date_format"),changeMonth:!0,changeYear:!0})}),e("#sale_date_from").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",onClose:function(t){e("#sale_date_upto").datepicker("option","minDate",t)}}),e("#sale_date_upto").datepicker({changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",onClose:function(t){e("#sale_date_from").datepicker("option","maxDate",t)}}),addMultiInputProperty=function(i){var o=i.data("limit");"undefined"==typeof o&&(o=-1),1==i.children(".multi_input_block").length&&i.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),i.children(".multi_input_block").length==o?i.find(".add_multi_input_block").hide():i.find(".add_multi_input_block").show(),i.children(".multi_input_block").each(function(){e(this)[0]!=i.children(".multi_input_block:last")[0]&&e(this).children(".add_multi_input_block").remove()}),i.children(".multi_input_block").find(".add_multi_input_block").off("click").on("click",function(){var a=i.attr("id"),n=i.data("name"),r=e(this).parent().find(".multi_input_block_element").attr("id").split("_").pop();r++;var d=i.children(".multi_input_block:first").clone(!1);d.find("textarea,input:not(input[type=button],input[type=submit],input[type=checkbox],input[type=radio])").val(""),d.find("input[type=checkbox]").attr("checked",!1),d.find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),i=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var o=t;i=o.find(".multi_input_block_element").data("name"),o.find("a span").css("display","none"),o.find("a").attr("id",a+"_"+i+"_"+r+"_display"),o.find("img").attr("src","").attr("id",a+"_"+i+"_"+r+"_display").addClass("placeHolder").css("display","inline-block"),o.find(".multi_input_block_element").attr("id",a+"_"+i+"_"+r).attr("name",n+"["+r+"]["+i+"]"),o.find(".upload_button").attr("id",a+"_"+i+"_"+r+"_button").show(),o.find(".remove_button").attr("id",a+"_"+i+"_"+r+"_remove_button").hide(),addDCUploaderProperty(o)}else t.attr("name",n+"["+r+"]["+i+"]"),t.attr("id",a+"_"+i+"_"+r),t.parent().parent().find(".checkbox_title").attr("for",n+"_"+i+"_"+r);t.hasClass("dc_datepicker")?t.removeClass("hasDatepicker").datepicker({dateFormat:t.data("date_format"),changeMonth:!0,changeYear:!0}):t.hasClass("time_picker")&&(e(".time_picker").timepicker("remove").timepicker({step:15}),t.timepicker("remove").timepicker({step:15}))}),d.find(".multi_input_holder").each(function(){t(e(this),a,n,r)}),d.children(".remove_multi_input_block").off("click").on("click",function(){var t=e(this).parent().parent(),i=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);e(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(i),t.children(".multi_input_block").length==o?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show(),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none")}),d.children(".add_multi_input_block").remove(),i.append(d),i.children(".multi_input_block:last").append(e(this)),i.children(".multi_input_block").length>1&&i.children(".multi_input_block").children(".remove_multi_input_block").css("display","block"),i.children(".multi_input_block").length==o?i.find(".add_multi_input_block").hide():i.find(".add_multi_input_block").show(),i.data("length",r)}),i.hasClass("multi_input_block_element")||i.children(".multi_input_block").css("padding-bottom","40px"),i.children(".multi_input_block").children(".multi_input_holder").length>0&&i.children(".multi_input_block").css("padding-bottom","40px"),i.children(".multi_input_block").children(".remove_multi_input_block").off("click").on("click",function(){var t=e(this).parent().parent(),i=t.children(".multi_input_block").children(".add_multi_input_block").clone(!0);e(this).parent().find(1==e('input[data-name="is_taxonomy"]').data("name"))&&($taxonomy=e(this).parent().find(e('input[data-name="tax_name"]')).val(),e("select.fpm_attribute_taxonomy").find('option[value="'+$taxonomy+'"]').removeAttr("disabled")),e(this).parent().remove(),t.children(".multi_input_block").children(".add_multi_input_block").remove(),t.children(".multi_input_block:last").append(i),1==t.children(".multi_input_block").length&&t.children(".multi_input_block").children(".remove_multi_input_block").css("display","none"),t.children(".multi_input_block").length==o?t.find(".add_multi_input_block").hide():t.find(".add_multi_input_block").show()})},e(".multi_input_holder").each(function(){var t=e(this);addMultiInputProperty(t)}),resetMultiInputIndex=function(t){var i=t.attr("id"),o=t.data("name"),a=0;t.find(".multi_input_block").each(function(){e(this).find(".dc-wp-fields-uploader,.multi_input_block_element:not(.multi_input_holder)").each(function(){var t=e(this),n=t.data("name");if(t.hasClass("dc-wp-fields-uploader")){var r=t;n=r.find(".multi_input_block_element").data("name"),r.find("img").attr("id",i+"_"+n+"_"+a+"_display").addClass("placeHolder"),r.find(".multi_input_block_element").attr("id",i+"_"+n+"_"+a).attr("name",o+"["+a+"]["+n+"]"),r.find(".upload_button").attr("id",i+"_"+n+"_"+a+"_button").show(),r.find(".remove_button").attr("id",i+"_"+n+"_"+a+"_remove_button").hide();var d=r.find("#"+i+"_"+n+"_"+a).val();d&&(r.find("#variations_image_"+a+"_button").hide(),r.find("#variations_image_"+a+"_remove_button").show())}else{var l=t.attr("multiple");"undefined"!=typeof l&&l!==!1?t.attr("name",o+"["+a+"]["+n+"][]"):t.attr("name",o+"["+a+"]["+n+"]"),t.attr("id",i+"_"+n+"_"+a)}}),e(".checkbox_title").each(function(){e(this).attr("for",e(this).next().find(".multi_input_block_element").attr("id"))}),a++})},e("button.fpm_add_attribute").on("click",function(){var t=e("select.fpm_attribute_taxonomy").val();if(t){var i={action:"generate_taxonomy_attributes",taxonomy:t};e("#attributes").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e.ajax({type:"POST",url:woocommerce_params.ajax_url,data:i,success:function(t){t&&($response=e(t),e("#attributes").append($response.find(".multi_input_block")),addMultiInputProperty(e("#attributes")),resetMultiInputIndex(e("#attributes")),e("#product_type").change(),e("#attributes").find(".multi_input_block:last").find("select").select2({placeholder:"Search for a attribute ..."}))}})}return t&&(e("select.fpm_attribute_taxonomy").find('option[value="'+t+'"]').attr("disabled","disabled"),e("select.fpm_attribute_taxonomy").val("")),e("#attributes").unblock(),!1}),e("#select_attributes").length>0&&(e("#attributes").append(e("#select_attributes").html()),e("#select_attributes").remove(),addMultiInputProperty(e("#attributes")),resetMultiInputIndex(e("#attributes")),e("#attributes").find(".multi_input_block").find("select").select2({placeholder:"Search for a attribute ..."})),e("#attributes").find(".multi_input_block").each(function(){e(this).find(1==e('input[data-name="is_taxonomy"]').data("name"))&&($taxonomy=e(this).find(e('input[data-name="tax_name"]')).val(),e("select.fpm_attribute_taxonomy").find('option[value="'+$taxonomy+'"]').attr("disabled","disabled"))}),$default_attributes=e('input[data-name="default_attributes_hidden"]'),$default_attributes.length>0&&($default_attributes_val=$default_attributes.val(),$default_attributes_val.length>0&&e.each(e.parseJSON($default_attributes_val),function(t,i){e(".default_attributes_holder").append('<input type="hidden" name="default_attribute_'+t+'" data-name="default_attribute_'+t+'" value="'+i+'" />')}));tinymce.init({selector:"#description",height:120,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste code"],toolbar:"undo redo | insert | styleselect | bold italic | alignleft aligncenter alignright alignjustify |  bullist numlist outdent indent | link image",content_css:"//www.tinymce.com/css/codepen.min.css",statusbar:!1,entity_encoding:"raw"});e("#pruduct_manager_draft_button").click(function(t){if(t.preventDefault(),$is_valid=i(),$is_valid){e("#product_manager_form").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e("#product_manager_form").find(":input:disabled").removeAttr("disabled");var o=tinymce.get("description").getContent({format:"raw"}),a={action:"frontend_product_manager",product_manager_form:e("#product_manager_form").serialize(),description:o,status:"draft",removed_variations:removed_variations,removed_person_types:removed_person_types};e.post(woocommerce_params.ajax_url,a,function(t){console.log(t),t&&($response_json=e.parseJSON(t),$response_json.status?"0"==$response_json.is_new?(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-message" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-message").focus()):window.location=$response_json.redirect:(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-error").focus()),$response_json.id&&e("#pro_id").val($response_json.id),e("#product_manager_form").unblock())})}}),e("#pruduct_manager_submit_button").click(function(t){if(t.preventDefault(),$is_valid=i(),$is_valid){e("#product_manager_form").block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),e("#product_manager_form").find(":input:disabled").removeAttr("disabled");var o=tinymce.get("description").getContent(),a={action:"frontend_product_manager",product_manager_form:e("#product_manager_form").serialize(),description:o,status:"submit",removed_variations:removed_variations,removed_person_types:removed_person_types};e.post(woocommerce_params.ajax_url,a,function(t){t&&($response_json=e.parseJSON(t),$response_json.status?"0"==$response_json.is_new?(e(".woocommerce-error,.woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-message" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-message").focus()):window.location=$response_json.redirect:(e(".woocommerce-error,woocommerce-message").remove(),e("#product_manager_form").prepend('<div class="woocommerce-error" tabindex="-1">'+$response_json.message+"</div>"),e(".woocommerce-error").focus()),$response_json.id&&e("#pro_id").val($response_json.id),e("#product_manager_form").unblock())})}})});